# Quick Charge Shift Analysis (CSA)

[![Video Tutorial](https://raw.githubusercontent.com/davidkastner/quickCSA/main/docs/_static/thumbnail.jpg)](https://www.youtube.com/watch?v=Zck8fznmTPA&t=27s&ab_channel=DavidW.Kastner)

## Table of Contents
1. **Overview**
    * Introduction
    * Code Objective
2. **Architecture**
    * Folder structure
    * User input
3. **Setup and install**
    * Setup developing environment
4. **Performing Analyses**
    * Step-by-step explanation
    * Example job

## I. Overview
### Introduction
The purpose of Quick CSA is to simplify the process of running charge shift analysis. In summary, charge shift analysis is a technique for systematically determining the residues that should be included in the QM region for QM/MM calculations. It is calculated by performing an electronic structure calculation for the apo and holo structures of a given enzyme. In the apo structure, the ligands and covalently bonded residues are rigidly removed. The comparision of the optimized apo and holo structures, will tell us which amino acids are significantly affected by charge transfer of the active site ligands.

### Code Objective
Performing charge shift analysis is a straight foward process. However, if it is routinely used for different enzymes it can become tedious to constantly change individual scripts for the calculation. In this verison of CSA, the scripts are generalized and easy to use, requiring minimal user input.

## II. Architecture
### Folder Structure
The folder structure is divided into three main folders. 1) The `1_input` directory contains the user's input files. 2) The `2_interm` directory contains intermediate files generated by the code during the CSA calculation. 3) The `3_output` directory contains the final results files for the user. The output consists of the charge difference for every amino acid and a second fild containing the charge difference just for the amino acids that saw a change in charge greater than 0.5.

### User Input
The user is expected to add three types of files to the `1_input` directory. 1) First, their holo PDB file, which can have any name as long as it has the extension PDB. The user should only add a single PDB file to this directory although the script will remind you of this if more than one is added. 2) Two files callded `apo_residues` and `holo_residues`. The should contain a single line with the residues that are included in the holo and apo strcutures. It should be of the form `1,2,3, etc.`. 3) The `charge_mull.xls` files from the TeraChem calculations. The xls file from the holo calculation should be given the name `holo_charge_mull.xls` and the xls file from the apo calculation should be given the name `apo_charge_mull.xls`.


## III. Setup and Install
### Setup developing environment
Remember to update your GitHub [ssh keys](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account).
```bash
git clone git@github.com:davidkastner/quickCSA.git
cd quickCSA
python -m pip install -e .
```

## IV. Performing Analyses
### Step-by-Step Explanation

See the `examples` directory.

The process of running Quick CSA is simple. After placing the initial files in the `1_input` directory, run the quick_csa.py with `python quick_csa.py`. The scipt will run through all the step automatically and deposit two sets of files in the `3_ouput` directory. One corresponds to a file with the charge differences for all residues in the apo mask and starts with `all`. The other starts with `cutoff` and contains only the residues that saw a difference greater than or equal to 0.05.
